<!DOCTYPE html>
<html>
<head>
    <title>Permission System Demo - MetaTask</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body class="bg-gray-50">
    <div class="max-w-6xl mx-auto py-8 px-4">
        <div class="mb-8">
            <h1 class="text-3xl font-bold text-gray-900 mb-2">
                <i class="fas fa-shield-alt text-blue-600 mr-3"></i>
                MetaTask Permission System Implementation
            </h1>
            <p class="text-gray-600">
                Complete role-based access control with user-friendly notifications
            </p>
        </div>

        <!-- Implementation Summary -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
            <div class="bg-white rounded-lg shadow-md p-6">
                <h2 class="text-xl font-semibold text-gray-900 mb-4">
                    <i class="fas fa-cogs text-green-600 mr-2"></i>
                    Backend Implementation
                </h2>
                <div class="space-y-3">
                    <div class="flex items-center">
                        <i class="fas fa-check-circle text-green-500 mr-2"></i>
                        <span class="text-sm">34 default permissions created</span>
                    </div>
                    <div class="flex items-center">
                        <i class="fas fa-check-circle text-green-500 mr-2"></i>
                        <span class="text-sm">Permission decorators on views</span>
                    </div>
                    <div class="flex items-center">
                        <i class="fas fa-check-circle text-green-500 mr-2"></i>
                        <span class="text-sm">Enhanced PermissionService</span>
                    </div>
                    <div class="flex items-center">
                        <i class="fas fa-check-circle text-green-500 mr-2"></i>
                        <span class="text-sm">Role-based access control</span>
                    </div>
                </div>
            </div>

            <div class="bg-white rounded-lg shadow-md p-6">
                <h2 class="text-xl font-semibold text-gray-900 mb-4">
                    <i class="fas fa-paint-brush text-blue-600 mr-2"></i>
                    Frontend Implementation
                </h2>
                <div class="space-y-3">
                    <div class="flex items-center">
                        <i class="fas fa-check-circle text-green-500 mr-2"></i>
                        <span class="text-sm">Permission template tags</span>
                    </div>
                    <div class="flex items-center">
                        <i class="fas fa-check-circle text-green-500 mr-2"></i>
                        <span class="text-sm">Notification components</span>
                    </div>
                    <div class="flex items-center">
                        <i class="fas fa-check-circle text-green-500 mr-2"></i>
                        <span class="text-sm">Permission-aware buttons</span>
                    </div>
                    <div class="flex items-center">
                        <i class="fas fa-check-circle text-green-500 mr-2"></i>
                        <span class="text-sm">Auto-hide functionality</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Permission Categories -->
        <div class="bg-white rounded-lg shadow-md p-6 mb-8">
            <h2 class="text-xl font-semibold text-gray-900 mb-4">
                <i class="fas fa-key text-yellow-600 mr-2"></i>
                Permission Categories
            </h2>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                <div class="border border-gray-200 rounded-lg p-4">
                    <h3 class="font-semibold text-indigo-900 mb-2">
                        <i class="fas fa-sitemap mr-1"></i>
                        Workflow (5 permissions)
                    </h3>
                    <ul class="text-xs text-gray-600 space-y-1">
                        <li>• workflow.create</li>
                        <li>• workflow.edit</li>
                        <li>• workflow.delete</li>
                        <li>• workflow.view</li>
                        <li>• workflow.configure</li>
                    </ul>
                </div>
                
                <div class="border border-gray-200 rounded-lg p-4">
                    <h3 class="font-semibold text-green-900 mb-2">
                        <i class="fas fa-tasks mr-1"></i>
                        Work Items (6 permissions)
                    </h3>
                    <ul class="text-xs text-gray-600 space-y-1">
                        <li>• workitem.create</li>
                        <li>• workitem.edit</li>
                        <li>• workitem.assign</li>
                        <li>• workitem.transition</li>
                        <li>• workitem.delete</li>
                        <li>• workitem.view</li>
                    </ul>
                </div>
                
                <div class="border border-gray-200 rounded-lg p-4">
                    <h3 class="font-semibold text-blue-900 mb-2">
                        <i class="fas fa-users mr-1"></i>
                        Teams (5 permissions)
                    </h3>
                    <ul class="text-xs text-gray-600 space-y-1">
                        <li>• team.create</li>
                        <li>• team.edit</li>
                        <li>• team.delete</li>
                        <li>• team.manage_members</li>
                        <li>• team.view</li>
                    </ul>
                </div>
                
                <div class="border border-gray-200 rounded-lg p-4">
                    <h3 class="font-semibold text-red-900 mb-2">
                        <i class="fas fa-user-cog mr-1"></i>
                        Users (5 permissions)
                    </h3>
                    <ul class="text-xs text-gray-600 space-y-1">
                        <li>• user.invite</li>
                        <li>• user.manage_roles</li>
                        <li>• user.deactivate</li>
                        <li>• user.view</li>
                        <li>• user.edit</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Demo Notification -->
        <div class="bg-white rounded-lg shadow-md p-6 mb-8">
            <h2 class="text-xl font-semibold text-gray-900 mb-4">
                <i class="fas fa-bell text-red-600 mr-2"></i>
                Permission Notification Demo
            </h2>
            <p class="text-gray-600 mb-4">
                When users try to access features they don't have permission for, they'll see a user-friendly notification like this:
            </p>
            
            <!-- Demo notification -->
            <div id="demoNotification" class="bg-red-50 border-l-4 border-red-400 p-4 mb-4 rounded-md">
                <div class="flex items-start">
                    <div class="flex-shrink-0">
                        <i class="fas fa-exclamation-triangle text-red-500 text-lg"></i>
                    </div>
                    <div class="ml-3 flex-1">
                        <h3 class="text-sm font-medium text-red-800">
                            Permission Required: Create Workflows
                        </h3>
                        <div class="mt-2 text-sm text-red-700">
                            <p>You don't have permission to create workflows. This action requires the 'workflow.create' permission.</p>
                            <p class="mt-2">
                                <strong>Need access?</strong> Contact your administrator to request workflow creation permissions.
                            </p>
                        </div>
                    </div>
                    <div class="ml-auto pl-3">
                        <button onclick="hideDemoNotification()" class="inline-flex text-red-400 hover:text-red-600">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                </div>
            </div>
            
            <button onclick="showDemoNotification()" class="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700">
                <i class="fas fa-play mr-2"></i>
                Show Demo Notification
            </button>
        </div>

        <!-- Code Examples -->
        <div class="bg-white rounded-lg shadow-md p-6">
            <h2 class="text-xl font-semibold text-gray-900 mb-4">
                <i class="fas fa-code text-purple-600 mr-2"></i>
                Implementation Examples
            </h2>
            
            <div class="space-y-6">
                <!-- View Decorator Example -->
                <div>
                    <h3 class="font-semibold text-gray-900 mb-2">1. View Permission Decorator</h3>
                    <div class="bg-gray-100 rounded-lg p-4 overflow-x-auto">
                        <pre class="text-sm"><code>@login_required
@require_organization_access
@require_permission('workflow.create')
def create_workflow(request):
    # View logic here
    pass</code></pre>
                    </div>
                </div>
                
                <!-- Template Permission Example -->
                <div>
                    <h3 class="font-semibold text-gray-900 mb-2">2. Template Permission Check</h3>
                    <div class="bg-gray-100 rounded-lg p-4 overflow-x-auto">
                        <pre class="text-sm"><code>{% load permission_tags %}

{% permission_button 'workflow.create' %}
    &lt;button class="btn-primary"&gt;Create Workflow&lt;/button&gt;
{% endpermission_button %}</code></pre>
                    </div>
                </div>
                
                <!-- Permission Filter Example -->
                <div>
                    <h3 class="font-semibold text-gray-900 mb-2">3. Permission Filter</h3>
                    <div class="bg-gray-100 rounded-lg p-4 overflow-x-auto">
                        <pre class="text-sm"><code>{% if user|has_permission:'team.edit' %}
    &lt;button class="edit-btn"&gt;Edit Team&lt;/button&gt;
{% endif %}</code></pre>
                    </div>
                </div>
            </div>
        </div>

        <!-- Status Summary -->
        <div class="mt-8 bg-green-50 border border-green-200 rounded-lg p-6">
            <div class="flex items-center">
                <i class="fas fa-check-circle text-green-600 text-2xl mr-3"></i>
                <div>
                    <h3 class="text-lg font-semibold text-green-900">Implementation Complete!</h3>
                    <p class="text-green-700">
                        The comprehensive permission system is now fully functional with backend decorators, 
                        frontend template integration, and user-friendly error notifications.
                    </p>
                </div>
            </div>
        </div>
    </div>

    <script>
        function showDemoNotification() {
            document.getElementById('demoNotification').style.display = 'block';
        }
        
        function hideDemoNotification() {
            document.getElementById('demoNotification').style.display = 'none';
        }
        
        // Auto-show demo on load
        setTimeout(() => {
            showDemoNotification();
            setTimeout(() => {
                hideDemoNotification();
            }, 8000);
        }, 1000);
    </script>
</body>
</html>
